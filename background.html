<html>
	<script>
		chrome.extension.onRequest.addListener(
			function(request, sender, sendResponse) {
				switch(request.type) {
					case 'get':
						var lastReadMsg = localStorage[request.topic];
						if(lastReadMsg != null) {
							lastReadMsg = parseInt(lastReadMsg);
						}
						var response = { 'lastReadMsg' : lastReadMsg };
						sendResponse(response);
						break;
						
					case 'set':
						localStorage[request.topic] = request.lastReadMsg;
						sendResponse({}); // snub them.
						break;
				}
			});
	</script>
</html>
